let sirscIteratorLastAction = '';const sirscIteratorInit = (element) =>{if (element){const button = document.getElementById(element);if (button){button.dataset.processing = 0;button.dataset.stopped = 0;button.classList.add('initiated');/*button.classList.add('disabled');*/sirscIteratorActivateElement(element,'start');sirscIteratorActivateElement(element,'stop');sirscIteratorResetElement(element,'resume');sirscIteratorActivateElement(element,'cancel');sirscIteratorResetElement(element,'finish');}}};const sirscIteratorResetElement = (element,action) =>{const item = document.getElementById(element + '-' + action);if (item){if ('start' === action){item.classList.remove('initiated');item.classList.remove('disabled');item.classList.remove('processing');}else{item.classList.add('hidden');}}};const sirscIteratorActivateElement = (element,action) =>{const item = document.getElementById(element + '-' + action);if (item){if ('start' === action){item.classList.add('initiated');item.classList.add('disabled');item.classList.add('processing');}else{item.classList.remove('hidden');}}};const sirscIteratorReset = (element) =>{if (element){const button = document.getElementById(element);if (button){button.dataset.processing = 0;button.dataset.stopped = 1;button.classList.remove('initiated');button.classList.remove('disabled');sirscIteratorResetElement(element,'start');sirscIteratorResetElement(element,'stop');sirscIteratorResetElement(element,'resume');sirscIteratorResetElement(element,'cancel');sirscIteratorResetElement(element,'finish');}}};const sirscIteratorStop = (element) =>{if (element){let button = document.getElementById(element);if (button){button.dataset.processing = 1;button.dataset.stopped = 1;const buttonStart = document.getElementById(element + '-start');buttonStart.classList.remove('processing');sirscIteratorActivateElement(element,'resume');sirscIteratorResetElement(element,'stop');sirscIteratorResetElement(element,'finish');button = document.getElementById(element);}}};const sirscIteratorContinue = (element) =>{if (element){const button = document.getElementById(element);if (button){if (button.dataset.stopped === 1 || button.dataset.stopped === '1'){return false;}return true;}}return false;};function sirscIterator(element,action,callback){sirscIteratorLastAction = action;if (action === 'reset' || action === 'cancel'){sirscIteratorReset(element);/* Fail-fast. */return;}if (action === 'start' || action === 'resume'){sirscIteratorInit(element,callback);}else if (action === 'stop'){sirscIteratorStop(element,callback);}else if (action === 'finish'){sirscIteratorReset(element);}if (sirscIteratorContinue(element,callback)){sirscResolve(callback);}setHiddenDataset(element);setTimeout(() =>{setHiddenDataset(element);},500);}const sirscIteratorRemoveElements = (elem) =>{if (typeof elem !== 'undefined'){if (elem.length>1){for (let i = 0;i < elem.length;i++){if (elem[i].parentNode){elem[i].parentNode.removeChild(elem[i]);}}}else{if (elem[0]){if (elem[0].parentNode){elem[0].parentNode.removeChild(elem[0]);}}else{if (elem.parentNode){elem.parentNode.removeChild(elem);}}}}};const sirscIteratorAssessCallback = () =>{const targetCallback = document.getElementById('sirsc-data-callback');if (targetCallback){sirscResolve(targetCallback.dataset.response);sirscIteratorRemoveElements(targetCallback);}const targetCallbackDelay = document.getElementById('sirsc-data-callback-delay');if (targetCallbackDelay){setTimeout(function (){sirscResolve(targetCallbackDelay.dataset.response);sirscIteratorRemoveElements(targetCallbackDelay);},sirscIteratorSettings.delay);}};const sirscIteratorAssessMessage = () =>{const targetMessage = document.querySelectorAll('.sirsc-response-message');if (targetMessage){setTimeout(function (){sirscIteratorRemoveElements(targetMessage);},sirscIteratorSettings.delay);}};function sirscIteratorGet(url,target,extraCall = null){const targetEl = document.getElementById(target);targetEl.classList.add('processing');fetch(sirscIteratorSettings.ajaxurl  +'?' +url +'&iterator=' +sirscIteratorLastAction +'&verify=' +sirscIteratorSettings.verify ,{method:'GET',mode:'cors',cache:'no-cache',credentials:'same-origin',}).then((response) =>{return response.text();}).then((data) =>{targetEl.textContent = data;targetEl.innerHTML = data;targetEl.classList.remove('processing');sirscIteratorAssessMessage();sirscIteratorAssessCallback();if (extraCall){sirscResolve(extraCall);}}).catch(() =>{sirscIteratorAssessCallback();sirscIteratorAssessMessage();});}const setHiddenDataset = (item) =>{if (item){const theElem = document.getElementById(item);if (theElem){const elems = theElem.querySelectorAll('.sirsc-iterator.hidden');theElem.dataset.visibles = 'len-' + (elems ? elems.length:0);}}};function sirscIterators(){const iterators = document.querySelectorAll('.sirsc-iterator-wrap');if (!iterators){return;}iterators.forEach((item) =>{item.addEventListener('click',(event) =>{event.preventDefault();event.stopPropagation();let action = 'start';if (event.target.id.endsWith('-start')){action = 'start';}else if (event.target.id.endsWith('-stop')){action = 'stop';}else if (event.target.id.endsWith('-resume')){action = 'resume';}else if (event.target.id.endsWith('-cancel')){action = 'cancel';}else if (event.target.id.endsWith('-finish')){action = 'finish';}item.dataset.action = action;sirscIterator(item.id,action,item.dataset.callback);});});}setTimeout(function (){sirscIterators();},1500);